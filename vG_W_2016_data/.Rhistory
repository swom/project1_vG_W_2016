mygraph <- graph_from_data_frame( edge_list )
library(ggraph)
mygraph <- graph_from_data_frame( edge_list )
library(igraph)
mygraph <- graph_from_data_frame( edge_list )
ggraph(mygraph, layout = 'tree') +
geom_edge_link0() +
geom_node_point() +
theme_void()
#saveRDS(mygraph,file = "phylogenesis_s1")
phylo = readRDS("phylogenesis_s1")
ggraph(phylo, layout = 'tree') +
geom_edge_link0() +
geom_node_point() +
theme_void()
ggraph(mygraph, layout = 'tree') +
geom_edge_diagonal() +
geom_node_point() +
theme_void()
ggraph(mygraph, layout = 'tree') +
geom_edge_diagonal() +
theme_graph()
geom_node_point() +
theme_void()
ggraph(mygraph, layout = 'tree') +
geom_edge_diagonal() +
geom_node_point() +
theme_graph()
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient(low = "red",
high = "green") +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient(low = "red",
mid = "blue",
high = "green") +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient(low = "red",
mid = "navy",
high = "green") +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient2(low = "red",
mid = "navy",
high = "green") +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient2(low="red", mid="navy", high="green",
limits=range(value)) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value, col = )) +
geom_tile(color = "black", size = 0.5) +
scale_fill_gradient2(low="red", mid="navy", high="green",
limits=range(rand_demographic$value)) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = "red",mid = "navy",high = "green")
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = "red",mid = "navy",high = "green")
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = "red",mid = "navy",high = "green")+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = "red",mid = "navy",high = "green"
, midpoint = max(value)/2)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
, midpoint = 5000)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = "red",mid = "navy",high = "green"
, midpoint = 5000)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(low = muted("red"),mid = "navy",high = "green"
, midpoint = 5000)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(mycol)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
mycol <- c("navy", "blue", "cyan", "lightcyan", "yellow", "red", "red4")
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient2(mycol)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient(mycol)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
mycol <- c("navy", "blue", "cyan", "lightcyan", "yellow", "red", "red4")
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient(mycol)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
rand_demographic %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = value)) +
scale_fill_gradient(mycol)+
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
new_rand_demo = rand_demographic %>%
mutate(
"ratio_value" = value / max(value)
)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
mutate(
"ratio_value" = value / max(value)
)
View(mygraph)
View(new_rand_demo)
View(new_rand_demo)
View(rand_demographic)
View(new_rand_demo)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
rand_demographic %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
View(new_rand_demo)
View(new_rand_demo)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(amplitude == "1.500000.csv") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ .)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "best_ind_random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "best_ind_random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "best_ind_random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
