library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
dir = dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(paste(dir,"/vG_W_2016_data",sep = ""))
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "best_ind_random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
View(new_rand_demo)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
View(new_rand_demo)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(seed < 51) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(seed < 51)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
sub( "^.*amplitude_(\\d+)",'\\1', i)
sub( "^.*amplitude_(\\d+).csv",'\\1', i)
sub( "^.*(\\d+)",'\\1', conditions$amplitude)
sub( "(\\d+)",'\\1', conditions$amplitude)
sub( "(\\d+).csv",'\\1', conditions$amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
dir = dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(paste(dir,"/vG_W_2016_data",sep = ""))
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
conditions$amplitude = sub( "(\\d+).csv",'\\1', conditions$amplitude)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
ggplot(aes(condition, seed, fill = ratio_value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
rand_demographic = data.frame()
for (i in  list.files(path = '.',pattern = "best_ind_random_cond_sim_demographic_s\\d+_change_\\d+_amplitude_\\d+.*"))
{
conditions = read.table(i, sep = ",")
conditions$seed = sub( "^.*s(\\d+).*",'\\1', i)
conditions$change = sub( "^.*change_(\\d+).*",'\\1', i)
conditions$amplitude = sub( "^.*amplitude_(\\d+)",'\\1', i)
conditions$amplitude = sub( "(\\d+).csv",'\\1', conditions$amplitude)
rand_demographic = rbind(conditions,rand_demographic)
}
n_columns = ncol(rand_demographic)
rand_demographic = rand_demographic[,-c(5: (n_columns - 3) )]
colnames(rand_demographic)= c("condition",
"active",
"spore",
"sporu",
"seed",
"change_freq",
"amplitude")
rand_demographic <- pivot_longer(
rand_demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
rand_demographic$amplitude = as.factor(rand_demographic$amplitude)
rand_demographic$change_freq = as.factor(rand_demographic$change_freq)
rand_demographic$seed = as.factor(rand_demographic$seed)
rand_demographic$condition = as.factor(rand_demographic$condition)
rand_demographic$variable = as.factor(rand_demographic$variable)
new_rand_demo = rand_demographic %>%
group_by(condition,change_freq) %>%
mutate(
"ratio_value" = value / max(value)
)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(seed) < 51) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(amplitude) < 3)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(amplitude) < 3) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
as.numeric(amplitude)
View(new_rand_demo)
rand_demographic$amplitude
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(amplitude) != 3)
as.numeric(new_rand_demo$amplitude) < 3
as.numeric(new_rand_demo$amplitude)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(amplitude) < 4) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
new_rand_demo %>%
subset(variable == "spore") %>%
subset(as.numeric(seed) < 51) %>%
subset(as.numeric(amplitude) < 2) %>%
ggplot(aes(condition, seed, fill = value)) +
geom_tile(color = "black", size = 0.5) +
facet_grid(change_freq  ~ amplitude)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
demographic = data.frame()
for (i in  list.files(path = '.',pattern = "sim_demographic_s\\d+change_\\d+"))
{
replicate = read.csv(i)
replicate$seed = sub( "^.*s(\\d+).*",'\\1', i);
replicate$change = sub( "^.*_(\\d+).*",'\\1', i)
colnames(replicate) = colnames(demographic)
demographic = rbind(replicate,demographic)
}
n_columns = ncol(demographic)
demographic = demographic[,-c(5: (n_columns - 2) )]
colnames(demographic)= c("cycle",
"active",
"spore",
"sporu" ,
"seed",
"change_freq")
demographic <- pivot_longer(
demographic,
cols = c("active", "spore", "sporu"),
names_to = "variable"
)
demographic$seed = as.factor(demographic$seed)
demographic$change_freq = as.factor(demographic$change_freq)
demographic$variable = as.factor(demographic$variable)
ggplot(demographic,aes(cycle,value, color = variable)) +
geom_point(alpha = 0.1)  +
facet_grid(change_freq ~ .)
demographic %>%
subset(variable == "spore") %>%
subset(cycle == max(cycle)) %>%
ggplot(aes(seed,value, color = seed)) +
geom_point()
demographic %>%
subset(seed == 1) %>%
ggplot(aes(cycle,value, color = variable)) +
geom_point(alpha = 0.1)  +
facet_grid(change_freq ~ .)
demographic %>%
ggplot(aes(cycle,value, color = variable)) +
geom_point(alpha = 0.1)  +
facet_grid(change_freq ~ seed)
demographic %>%
subset(seed < 6) %>%
ggplot(aes(cycle,value, color = variable)) +
geom_point(alpha = 0.1)  +
facet_grid(change_freq ~ seed)
demographic %>%
subset(as.numeric(seed) < 6) %>%
ggplot(aes(cycle,value, color = variable)) +
geom_point(alpha = 0.1)  +
facet_grid(change_freq ~ seed)
